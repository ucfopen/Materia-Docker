FROM php:5.6.19-fpm-alpine
MAINTAINER Ian Turgeon

RUN apk update && apk add \
  bash \
  git \
  libmcrypt-dev \
  libmemcached-dev \
  libpng-dev \
  libxml2-dev \
  zlib-dev

# PECL Libraries
# memcached build manually
RUN docker-php-ext-install \
	bcmath \
	gd \
	mbstring \
	mcrypt \
	pdo_mysql \
	xml \
	zip \
	&& pecl download memcached \
	&& tar zxvf memcached-2.2.0.tgz \
	&& cd memcached-2.2.0 \
	&& phpize \
	&& ./configure --disable-memcached-sasl \
	&& make \
	&& make install \
	&& docker-php-ext-enable memcached \
	&& rm -rf /usr/src/php

# Make sure composer is installed globally
RUN bash -c "curl -sS https://getcomposer.org/installer | php && mv composer.phar /usr/local/bin/composer"

# add script that helps us wait for other containers
COPY config/wait-for-it.sh /wait-for-it.sh
RUN chmod +x /wait-for-it.sh

