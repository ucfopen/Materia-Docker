FROM ruby:2.3.4-alpine

RUN apk add --no-cache \
  build-base \
  git \
  libjpeg-turbo-dev \
  python \
  python-dev \
  py-pip \
  bash

RUN git clone https://github.com/samuel-belcastro/fake-s3.git /tmp/fake-s3

WORKDIR /tmp/fake-s3
RUN gem build fakes3.gemspec
RUN gem install fakes3-1.2.0.gem
WORKDIR /

# Install Python dependencies only required for this container
RUN pip install watchdog
RUN pip install requests
RUN pip install boto3 # lambda supports this library

# run fake-s3
RUN mkdir -p /s3mnt

EXPOSE 10001
